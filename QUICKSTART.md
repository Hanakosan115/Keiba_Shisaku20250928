# クイックスタートガイド

## 📦 セットアップ（初回のみ）

### 1. 必要なパッケージをインストール

```bash
pip install -r requirements.txt
```

または個別にインストール：

```bash
pip install pandas numpy lightgbm scikit-learn matplotlib requests beautifulsoup4 lxml selenium
```

## 🚀 起動方法

### 改善版アプリケーションを起動

```bash
cd C:\Users\bu158\Keiba_Shisaku20250928
python run_improved_analyzer.py
```

または：

```bash
py run_improved_analyzer.py
```

## 📝 基本的な使い方

### 1. データ収集（初回のみ）

1. アプリケーションを起動
2. **「データ」タブ**を開く
3. 収集期間を設定（例：2023年1月～2023年12月）
4. **「データ収集開始」**ボタンをクリック

⚠️ **注意**:
- 初回は短期間（1～2ヶ月）でテストしてください
- サイトへの負荷を考慮し、適切な待機時間を設定してください
- netkeiba.comの利用規約を遵守してください

### 2. モデルの学習（データ収集後）

1. **「データ」タブ**で「モデル学習」を実行
2. 学習完了まで待機（数分～数十分）
3. モデルファイルが保存されます

### 3. レース予測

1. **「予測」タブ**を開く
2. レースIDを入力
   - 例: `202406010101`
   - netkeiba.comのレースURLから取得
   ```
   https://race.netkeiba.com/race/shutuba.html?race_id=202406010101
                                                     ↑この12桁
   ```
3. **「レース情報表示」**ボタンをクリック
4. 予測結果が表示されます

## 📊 予測結果の見方

### 表示項目

| 列 | 説明 |
|----|------|
| **印** | ◎○▲△の評価 |
| **馬番** | 馬番号 |
| **馬名** | 馬の名前 |
| **オッズ** | 単勝オッズ |
| **人気** | 人気順位 |
| **AI予測(%)** | AIによる複勝確率 |
| **オッズ予測(%)** | オッズから算出される確率 |
| **乖離度** | AI予測 - オッズ予測 |
| **自信度** | S/A/B/Cの評価 |

### 印の意味

- **◎（本命）**: 最も評価が高い馬
- **○（対抗）**: 2番目に評価が高い馬
- **▲（単穴）**: 穴馬候補
- **△（連下）**: 連下候補

### 自信度の意味

- **S級**: 鉄板（90%以上の信頼度）
- **A級**: 高い信頼度（70-89%）
- **B級**: 中程度（50-69%）
- **C級**: 低い（50%未満）

### 乖離度の意味

- **+5%以上**: AIがオッズより高評価 → **穴馬候補**
- **±5%以内**: オッズと一致 → 妥当な評価
- **-5%以下**: AIがオッズより低評価 → **過大評価の可能性（注意）**

### 活用例

#### パターン1: 鉄板レース
```
◎ 5番 スターホース  オッズ2.5倍  AI予測35%  乖離度+2%  自信度S
```
→ **堅実に本命から**

#### パターン2: 穴馬発見
```
▲ 12番 ダークホース  オッズ15倍  AI予測12%  乖離度+5.3%  自信度A
```
→ **人気薄だがAI高評価！狙い目**

#### パターン3: 人気馬に注意
```
- 3番 人気馬  オッズ4.5倍  AI予測10%  乖離度-12%  自信度C
```
→ **人気だがAI評価低い。過大評価の可能性**

## 🔧 トラブルシューティング

### Q: モジュールが見つからないエラー
```
ModuleNotFoundError: No module named 'pandas'
```

**A**: パッケージをインストールしてください
```bash
pip install pandas
```

### Q: レース情報が取得できない
```
レースID 202406010101 の出馬表を取得できませんでした
```

**A**: 以下を確認してください
- レースIDが正しいか（12桁の数字）
- レースが実際に存在するか
- インターネット接続が正常か

### Q: 予測モデルが見つからない
```
予測モデルが見つかりません
```

**A**: 以下の手順でモデルを作成してください
1. データ収集を実行
2. モデル学習を実行

### Q: 日本語が文字化けする
**A**: Windowsコマンドプロンプトの表示の問題です。プログラム自体は正常に動作しています。GUIでは正しく表示されます。

## 📖 詳細情報

詳しい説明は以下を参照してください：
- `README_IMPROVED.md` - 改善内容の詳細
- `improved_analyzer.py` - 分析エンジンのソースコード
- `backtest.py` - バックテスト機能

## 💡 ヒント

1. **初回は少量のデータでテスト**
   - 1～2ヶ月分のデータで試してみる
   - 動作確認後、期間を拡大

2. **バックテストで精度確認**
   ```bash
   python backtest.py
   ```

3. **設定ファイルのカスタマイズ**
   - `settings.json`で各種設定を変更可能

4. **定期的なデータ更新**
   - 新しいレースデータを定期的に収集
   - モデルを再学習して精度を維持

## ⚠️ 重要な注意事項

1. **競馬は確率のゲームです**
   - どんなに優れたAIでも100%の的中は不可能
   - 1番人気の的中率でも約30-35%程度

2. **馬券購入は自己責任で**
   - 余裕資金で楽しむ
   - 依存症に注意

3. **Webスクレイピングについて**
   - netkeiba.comの利用規約を遵守
   - robots.txtを確認
   - 適切な待機時間を設定

---
**Good Luck & Enjoy!** 🏇
